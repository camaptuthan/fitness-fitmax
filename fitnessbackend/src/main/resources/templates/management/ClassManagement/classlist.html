<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
    <th:block th:insert="/fragments/admin_fragment/head"></th:block>
    <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/js/richtexteditor/rte_theme_default.css}">
</head>
<th:block th:insert="/fragments/admin_fragment/header"></th:block>
<!-- Mirrored from educhamp.themetrades.com/demo/admin/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 22 Feb 2019 13:08:15 GMT -->

<body class="ttr-opened-sidebar ttr-pinned-sidebar">
<th:block th:insert="/fragments/admin_fragment/sidebar_fragment"></th:block>
<!-- Left sidebar menu end -->

<!--Main container start -->
<main class="ttr-wrapper">
    <div class="container-fluid">
        <div class="db-breadcrumb">
            <h4 class="breadcrumb-title">Class</h4>
            <ul class="db-breadcrumb-list">
                <li><a href="#"><i class="fa fa-home"></i>Home</a></li>
                <li>Class</li>
            </ul>
        </div>

        <div class="row">
            <!-- Your Profile Views Chart -->
            <div class="col-lg-12 m-b30">
                <div class="widget-box">

                    <div class="wc-title row">
                        <h4>Class List</h4>
                        <div class="btn-light btn-outline-success ml-auto mr-3 row col-2"><a
                                th:href="@{/service/class/management/classes/new}">
                            <i class="fa fa-plus-circle" style="font-size:18px"></i>
                            <spam clas="mb-5">Add new class</spam>
                        </a>
                        </div>
                    </div>

                    <div class="container-fluid row ml-5 mt-5">
                        <div class="col-lg-12 col-12 col-md-12 col-sm-12 row">
                            <form th:action="@{/service/class/management/classes}" th:method="get" class="col-12 row">
                                <div class="col-3" id="city-selector">
                                    <div class="input-group flex-nowrap">
                                        <span class="input-group-text " id="addon-wrapping-city">City</span>
                                        <select aria-label="Default select example"
                                                class="form-select w-100" name="cityName"
                                                onchange="studioGenerator(this.value)"
                                                th:id="city-selector">
                                            <option value="">All</option>
                                            <th:block th:each="city : ${cities}">
                                                <option
                                                        th:selected="${city.name == currentCity}"
                                                        th:text="${city.name}"
                                                        th:value="${city.name}"></option>
                                            </th:block>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="input-group flex-nowrap" id="studio-selector">
                                        <span class="input-group-text" id="addon-wrapping-studio">Studio</span>
                                        <select aria-label="Default select example"
                                                class="form-select w-100" name="studioId">
                                            <option value="">All</option>
                                            <th:block th:each="studio : ${studios}">
                                                <option
                                                        th:selected="${studio.id == currentStudio}"
                                                        th:text="${studio.name}"
                                                        th:value="${studio.id}"></option>
                                            </th:block>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="input-group flex-nowrap" id="status-selector">
                                        <span class="input-group-text" id="addon-wrapping-status">Status</span>
                                        <select aria-label="Default select example"
                                                class="form-select w-100" name="status">
                                            <option value="">All</option>
                                            <th:block th:each="status : ${statuses}">
                                                <option
                                                        th:selected="${status.type_id == currentStatus}"
                                                        th:text="${status.statusName}"
                                                        th:value="${status.type_id}"></option>
                                            </th:block>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <button class="btn btn-primary" type="submit">View</button>
                                </div>
                            </form>
                            <script>
                                const origin_path = window.location.origin;
                                const studioGenerator = (cityId) => {

                                    $.ajax({
                                        url: `${origin_path}/address/studio/${cityId === "" ? '-1' : cityId}`,
                                        type: "GET",
                                        success: function (data) {
                                            const studioSelector = $("#studio-selector");
                                            studioSelector.html(``);
                                            let body = ` <span class="input-group-text" id="addon-wrapping-studio">Studio</span>
                                                             <select class="w-100"  name="studioId"><option value="">All</option>`;
                                            data.forEach(studio => {
                                                body += `<option value="${studio.id}">${studio.name}</option>`;
                                            })
                                            body += `</select>`;
                                            studioSelector.html(body);
                                        }
                                    })
                                }
                            </script>
                        </div>
                    </div>

                    <div class="widget-inner">
                        <table class="table table-hover table-bordered sortable" id="class_table">
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Studio</i></th>
                                <th>City</i></th>
                                <th>Created Date</i></th>
                                <th>Status</i></th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            <th:block th:each="item : ${list}">
                                <tr>
                                    <td th:text=" ${item.servicesName}"></td>
                                    <td th:text="${item.servicesStudioId == null ? 'All': item.servicesStudioId}"></td>
                                    <td th:text="${item.servicesCityName}"></td>
                                    <td th:text="${item.servicesDate}"></td>
                                    <th:block th:each="status : ${statuses}">
                                        <td th:text="${status.statusName}" th:if="${status.type_id == item.servicesStatus}"></td>
                                    </th:block>

                                    <td>
                                        <a class="btn btn-primary"
                                           th:href="@{/service/class/management/classes/{id}(id=${item.servicesId})}">
                                            View
                                        </a>
                                    </td>
                                </tr>
                            </th:block>
                            </tbody>
                        </table>
                        <div id="pagination">
                            <nav aria-label="Page navigation example">
                                <ul class="pagination justify-content-center">
                                    <li class="page-item" th:classappend="${currentPage - 1 == 0 ? 'disabled':''}">
                                        <a class="page-link"
                                           tabindex="-1"
                                           th:href="@{/service/class/management/classes(page=${currentPage}-1,cityName=${currentCity},studioId=${currentStudio},status=${currentStatus})}">Previous</a>
                                    </li>
                                    <th:block th:each="page: ${#numbers.sequence(1, totalPage)}">
                                        <li class="page-item" th:classappend="${currentPage == page} ? 'active' : ''">
                                            <a class="page-link"
                                               th:href="@{/service/class/management/classes(page=${page},cityName=${currentCity},studioId=${currentStudio},status=${currentStatus})}"
                                               th:text="${page}">1</a>
                                        </li>
                                    </th:block>
                                    <li class="page-item"
                                        th:classappend="${currentPage + 1 > totalPage ? 'disabled':''}">
                                        <a class="page-link"
                                           th:href="@{/service/class/management/classes(page=${currentPage}+1,cityName=${currentCity},studioId=${currentStudio},status=${currentStatus})}">Next</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    </div>
</main>
<div class="ttr-overlay"></div>

<!-- External JavaScripts -->
<th:block th:insert="/fragments/admin_fragment/script"></th:block>
</body>
<script crossorigin="anonymous"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>

<script th:hidden="true" th:inline="javascript">
    $(document).ready(function () {
        $('#class_table')
            .DataTable({
                // dom: 'rtip',
                columnDefs: [{
                    target: 0,
                    visible: true,
                    searchable: false
                }],
                "order": [3, 'desc'],
                pagingType: 'full_numbers',
                paging: false,
                info: false,
                searching: false,
            });
    });
</script>
<style>
    .bootstrap-select .dropdown-toggle {
        color: black !important;
    }

    .bootstrap-select .dropdown-toggle:hover {
        color: black !important;
    }
</style>
</html>