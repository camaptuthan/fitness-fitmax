<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Fitmax - Blog</title>
    <!-- =================== META =================== -->
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <th:block th:replace="fragments/head :: head"></th:block>
    <link rel="stylesheet" th:href="@{/js/richtexteditor/rte_theme_default.css}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- jQuery Validation Plugin -->
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>

</head>

<body id="home">
<!--================ PRELOADER ================-->
<div class="preloader-cover">
    <div id="cube-loader">
        <div class="caption">
            <div class="cube-loader">
                <div class="cube loader-1"></div>
                <div class="cube loader-2"></div>
                <div class="cube loader-4"></div>
                <div class="cube loader-3"></div>
            </div>
        </div>
    </div>
</div>
<!--============== PRELOADER END ==============-->

<!-- ================= HEADER ================= -->
<div th:include="fragments/header.html"></div>
<!-- =============== HEADER END =============== -->

<!-- =============== HEADER-TITLE =============== -->
<section class="s-header-title" style="background-image: url(/img/bg-1-min.png);">
    <div class="container">
        <h1 class="title">Blog</h1>
        <ul class="breadcrambs">
            <li><a th:href="@{/}">Home</a></li>
            <li><a th:href="@{/blog}">Blog</a></li>
        </ul>
    </div>
</section>
<!-- ============= HEADER-TITLE END ============= -->

<!--===================== S-NEWS =====================-->
<section class="s-news">
    <div class="container">
        <div class="row" style="justify-content: center">
            <div class="col-12 col-lg-10 blog-cover">
                <div class="post-item-cover">
                    <form class="search-form d-block" enctype="multipart/form-data" id="blog_update_form"
                          method="post" th:action="@{/blog/updateblog/{id} (id = ${blogDTO.id})}"
                          th:object="${blogDTO}">
                        <fieldset disabled>
                            <div class="mb-3 row">
                                <label class=" col-form-label" for="blog_author">Author</label>
                                <br>
                                <div >
                                    <input class="form-control-plaintext" disabled id="blog_author" readonly
                                           style="border-bottom-color: unset;"
                                           th:value="${authorEmail}" type="text">
                                </div>
                            </div>
                        </fieldset>
                        <div class="mb-3">
                            <label class="form-label" for="blog_title">Blog title</label>
                            <input class="form-control" id="blog_title" placeholder="Title" required
                                   th:field="${blogDTO.title}"
                                   th:name="blog_title" type="text">
                        </div>
                        <div class="mb-3">
                            <label class="btn btn-primary" for="fileImage">Change Thumbnail</label>
                            <input accept="image/jpeg, image/png" class="form-control-file" id="fileImage"
                                   name="fileImage"
                                   style="display: none" type="file"/>
                            <div class="my-3 w-100 h-100" id="blog_thumbnail">
                                <img th:field="${blogDTO.thumbnail}" th:src="${blogDTO.thumbnail}" alt="img">
                            </div>
                        </div>
                        <script>
                            $("#fileImage").on("change", () => {
                                const file = $("#fileImage")[0].files[0];
                                const reader = new FileReader();
                                reader.onload = () => {
                                    $("#blog_thumbnail").html(`<img src="${reader.result}" alt="img" style="width: 800px; height: 600px">`);
                                }
                                reader.readAsDataURL(file);
                            })

                        </script>
                        <div class=" mb-3">
                            <label class="form-label">Category</label>
                            <br>
                            <select class="form-select" id="category_id" name="category_id"
                                     th:field="${blogDTO.categoryId}" th:name="category_id">
                                <option th:each="cate:${catelist}" th:text="${cate.name}" th:value="${cate.id}">
                                </option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label" for="blog_content">Blog Content</label>
                            <textarea id="blog_content" style="width: 100%" th:field="${blogDTO.description}"
                                      th:name="blog_des">
                            </textarea>
                        </div>
                        <button class="btn btn-success" style="background-color: #1e7e34; border: 2px solid #1e7e34"
                                type="submit">Update
                        </button>
                        <button class="btn btn-primary" th:href="@{/blog}">Cancel</button>
                    </form>
                </div>

            </div>
        </div>
    </div>
</section>
<!--=================== S-NEWS END ===================-->

<!-- ================== FOOTER ================== -->
<div th:include="fragments/footer.html"></div>
<!-- ================ FOOTER END ================ -->

<!--=================== TO TOP ===================-->
<a class="to-top" href="#home">
    <i class="fa fa-chevron-up" aria-hidden="true"></i>
</a>
<!--================= TO TOP END =================-->

<!--=================== SCRIPT	===================-->

<script th:src="@{/js/slick.min.js}"></script>
<script th:src="@{/js/rx-lazy.js}"></script>
<script th:src="@{/js/parallax.min.js}"></script>
<script th:src="@{/js/scripts.js}"></script>
<script th:src="@{/js/richtexteditor/all_plugins.js}" type="text/javascript"></script>
<script th:src="@{/js/richtexteditor/rte.js}" type="text/javascript"></script>
<script crossorigin="anonymous"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
<script>
    $(document).ready(function () {
        $("#blog_update_form").validate({
            // Specify validation rules
            rules: {
                blog_title: "required",
            },

            // Specify validation error messages
            messages: {
                blog_title: "Please enter title",
            },

            // Submit form if validation passes
            submitHandler: function (form) {
                form.submit();
            }
        });
    });
</script>
<script>
    $("#blog_img").on("change", () => {
        const file = $("#blog_img")[0].files[0];
        const reader = new FileReader();
        reader.onload = () => {
            $("#blog_thumbnail").html(`<img src="${reader.result}" alt="img" style=" object-fit: cover;">`);
        }
        reader.readAsDataURL(file);
    })

    //get category all
    $.ajax({
        url: "/category/type/blog",
        type: "GET",
        success: (res) => {
            console.log(res);
            res.forEach((item) => {
                $("#blog_cate").append(`<option value="${item.id}">${item.des}</option>`);
            })
        },
        error: (err) => {
            console.log(err);
        }
    });

    let editor1 = new RichTextEditor("#blog_content",{contentCssText:"body{color:#f0f0f0;background-color:#3b3737}",fontSizeItems:"8,9,10,11,12,13,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,52,54,56,58,60,62,64,66"});
</script>

</html>