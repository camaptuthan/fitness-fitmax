<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Fitmax</title>
    <!-- =================== META =================== -->
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- jQuery Validation Plugin -->
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
    <script th:src="@{/js/validate/validate-profile.js}"></script>
    <th:block th:replace="fragments/head :: head"></th:block>
</head>

<body id="home">
<!--================ PRELOADER ================-->
<div class="preloader-cover">
    <div id="cube-loader">
        <div class="caption">
            <div class="cube-loader">
                <div class="cube loader-1"></div>
                <div class="cube loader-2"></div>
                <div class="cube loader-4"></div>
                <div class="cube loader-3"></div>
            </div>
        </div>
    </div>
</div>
<!--============== PRELOADER END ==============-->

<!-- ================= HEADER ================= -->
<div th:include="fragments/header.html"></div>
<!-- =============== HEADER END =============== -->
<div class="container mt-5">
    <div class="main-body">
        <div class="row gutters-sm" th:object="${user}">
            <div class="col-md-4 mb-3">
                <div class="card">
                    <form  th:action="@{/user/avataruser/{email} (email=${user.email})}" method="POST"
                          th:object="${user}" enctype="multipart/form-data">
                        <div class="card-body">
                            <div class="d-flex flex-column align-items-center text-center">
                                <div>
                                    <img th:src="${user.avatar != null ? user.avatar : 'https://bootdey.com/img/Content/avatar/avatar7.png'}"
                                         class="rounded-circle" style="border: 1px solid rgba(242, 56, 73, .25); height: 200px; width: 200px;">
                                    <div class="mt-3">
                                        <h3>[[${user.firstName}+' '+${user.lastName}]]</h3>
                                        <p class="text-secondary mb-1">[[${user.phone}]]</p>
                                        <p class="font-size-sm">[[${user.address}]]</p>
                                    </div>
                                    <div class="form-group">
                                        <br>
                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-primary" data-toggle="modal"
                                                data-target="#profile_avatar">
                                            Change Avatar
                                        </button>

                                        <!-- Modal -->
                                        <div class="modal fade" id="profile_avatar" tabindex="-1" role="dialog"
                                             aria-labelledby="profile_avatar_label" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="profile_avatar_label">Modal
                                                            title</h5>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                                aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <form th:action="@{/user/management/avataruser/{email} (email=${user.email})}"
                                                              method="POST" th:object="${user}"
                                                              enctype="multipart/form-data">
                                                            <div>
                                                                <div id="up-img">
                                                                    <img th:src="${user.avatar != null ? user.avatar : 'https://bootdey.com/img/Content/avatar/avatar7.png'}">
                                                                </div>
                                                                <div class="form-group">
                                                                    <br>
                                                                    <label for="fileImage" class="btn btn-primary">Upload
                                                                        Avatar</label>
                                                                    <input type="file" name="fileImage" id="fileImage"
                                                                           accept="image/jpeg, image/png"
                                                                           class="form-control-file" hidden=""/>
                                                                </div>
                                                            </div>
                                                        </form>

                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="submit" class="btn btn-primary"
                                                                th:value="${user.email}" onclick="update(this.value)">
                                                            Save changes
                                                        </button>
                                                    </div>
                                                    <script>
                                                        const update = (email) => {
                                                            const file_img = $("#fileImage")[0].file[0];
                                                            const api_path = `http://localhost:8080/user/management/avataruser/${email}?fileImage=${file_img}`
                                                            $.get(api_path, (result) => {
                                                                console.log(result);
                                                            })
                                                        }
                                                    </script>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>

                        </div>
                    </form>
                </div>

            </div>

            <div class="col-md-8">
                <div class="card mb-3">
                    <form id="profile-form" th:action="@{/user/updateprofile/{email} (email=${user.email})}" method="POST"
                          th:object="${user}" enctype="multipart/form-data">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Email</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <a  href="/cdn-cgi/l/email-protection" class="__cf_email__"
                                       data-cfemail="c6a0afb686acb3adabb3aee8a7aa" th:utext="*{email}"></a>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">First Name</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input
                                            name="firstName"
                                            placeholder="Enter your first name"
                                            th:field="*{firstName}"
                                            type="text"
                                            style="background: #202020; color: whitesmoke"
                                            id="firstname"
                                            required
                                    />

                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Last Name</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input
                                            name="lastName"
                                            placeholder="Enter your last name"
                                            th:field="*{lastName}"
                                            type="text"
                                            required
                                            style="background: #202020; color: whitesmoke"
                                            id="lastname"
                                    />

                                </div>
                            </div>
                            <hr>

                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Phone</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input
                                            name="name"
                                            placeholder="Enter your phone"
                                            th:field="*{phone}"
                                            type="text"
                                            required
                                            style="background: #202020; color: whitesmoke"
                                            id="phone"
                                    />

                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-3">
                                    <h6 class="mb-0">Address</h6>
                                </div>
                                <div class="col-sm-9 text-secondary">
                                    <input
                                            name="address"
                                            placeholder="Enter your address"
                                            th:field="*{address}"
                                            type="text"
                                            required
                                            style="background: #202020; color: whitesmoke"
                                            id="address"
                                    />
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-12">
                                    <button class="btn btn-primary" type="submit">Update</button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="row gutters-sm">
                    <div class="col-sm-6 mb-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h6 class="d-flex align-items-center mb-3"><i class="material-icons text-info mr-2">assignment</i>Project
                                    Status</h6>
                                <small>Web Design</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 80%"
                                         aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>Website Markup</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 72%"
                                         aria-valuenow="72" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>One Page</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 89%"
                                         aria-valuenow="89" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>Mobile Template</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 55%"
                                         aria-valuenow="55" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>Backend API</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 66%"
                                         aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 mb-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h6 class="d-flex align-items-center mb-3"><i class="material-icons text-info mr-2">assignment</i>Project
                                    Status</h6>
                                <small>Web Design</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 80%"
                                         aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>Website Markup</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 72%"
                                         aria-valuenow="72" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>One Page</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 89%"
                                         aria-valuenow="89" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>Mobile Template</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 55%"
                                         aria-valuenow="55" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small>Backend API</small>
                                <div class="progress mb-3" style="height: 5px">
                                    <div class="progress-bar bg-default" role="progressbar" style="width: 66%"
                                         aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center w-100">
            <div th:include="management/ScheduleManagement/schedule_table"></div>
        </div>
    </div>

</div>


<!-- ================== FOOTER ================== -->

<!-- ================== FOOTER ================== -->

<div th:include="fragments/footer.html"></div>
<!-- ================ FOOTER END ================ -->

<!--=================== TO TOP ===================-->

<!--================= TO TOP END =================-->

<!--=================== SCRIPT	===================-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<script th:src="@{/js/slick.min.js}"></script>
<script th:src="@{/js/rx-lazy.js}"></script>
<script th:src="@{/js/parallax.min.js}"></script>
<script th:src="@{/js/scripts.js}"></script>
<style>
    .card {
        --bs-card-bg: #202020;
        --bs-card-border-color: rgba(242, 56, 73, .25)
    }

    .text-secondary {
        color: white !important;
    }

    .nav-link {
        color: white !important;
    }

    .nav-link.active {
        color: #f23849 !important;
        background-color: transparent !important;
    }
</style>
</body>
<script>
    $("#fileImage").on("change", () => {
        const file = $("#fileImage")[0].files[0];
        const reader = new FileReader();
        reader.onload = () => {
            $("#up-img").html(`<img src="${reader.result}" alt="img" style=" height: 200px; width: 200px;">`);
        }
        reader.readAsDataURL(file);
    })

</script>

</html>
